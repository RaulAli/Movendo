<div class="dashboard-container">
    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <h2>Dashboard</h2>
        </div>
        <ul class="nav-list">
            <li *ngFor="let item of menuItems" class="nav-item" [class.active]="item === selectedMenuItem"
                (click)="selectMenuItem(item)">
                {{ item }}
            </li>
        </ul>
    </nav>

    <!-- Main -->
    <main class="main-content">
        <header class="content-header">
            <h1>{{ selectedMenuItem }}</h1>
        </header>

        <!-- Main -->
        <div *ngIf="selectedMenuItem === 'Main'" class="dashboard-grid">
            <div *ngFor="let card of cards" class="card">
                <div class="card-header">
                    <h3>{{ card.title }}</h3>
                </div>
                <p>{{ card.content }}</p>
                <div class="card-footer">
                    <button class="card-btn" (click)="onVerMas(card)">Ver m√°s</button>
                </div>
            </div>
        </div>

        <!-- Events -->
        <div *ngIf="selectedMenuItem === 'Events' && !editingEvento && !creatingEvento">
            <div class="action-bar" [formGroup]="filterForm">
                <div class="filters">
                    <input type="text" placeholder="Buscar por nombre..." formControlName="nombre" />
                    <div class="filter-group">
                        <button (click)="showCityFilters = !showCityFilters">Ciudad</button>
                        <div class="checkbox-group" *ngIf="showCityFilters">
                            <div *ngFor="let city of cities">
                                <input type="checkbox" [value]="city.nombre"
                                    [checked]="filterForm.get('ciudad')?.value.includes(city.nombre)"
                                    (change)="onCheckboxChange($event, 'ciudad')" />
                                {{ city.nombre }}
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <button (click)="showCategoryFilters = !showCategoryFilters">Categor√≠a</button>
                        <div class="checkbox-group" *ngIf="showCategoryFilters">
                            <div *ngFor="let category of categories">
                                <input type="checkbox" [value]="category.nombre"
                                    [checked]="filterForm.get('categoria')?.value.includes(category.nombre)"
                                    (change)="onCheckboxChange($event, 'categoria')" /> {{ category.nombre }}
                            </div>
                        </div>
                    </div>
                    <div class="filter-group">
                        <h5>Estado</h5>
                        <div>
                            <input type="checkbox" formControlName="isActive" /> Activo
                        </div>
                    </div>
                </div>
                <button class="btn-icon btn-add" (click)="onCreateEvento()" title="Crear Evento">‚ûï CREATE</button>
            </div>
            <div class="event-grid">
                <div class="event-grid-header">
                    <span>Nombre</span>
                    <span>Ciudad</span>
                    <span>Categor√≠a</span>
                    <span>Precio</span>
                    <span>Estado</span>
                    <span>Acciones</span>
                </div>
            </div>
            <div *ngFor="let e of filteredEventos" class="event-grid-row">
                <span>{{ e.nombre }}</span>
                <span>{{ e.ciudad }}</span>
                <span><span class="category-badge">{{ e.category }}</span></span>
                <span class="event-price">{{ e.price | currency:'USD' }}</span>
                <span>
                    <label class="toggle-switch">
                        <input type="checkbox" [checked]="e.isActive" disabled>
                        <span class="slider"></span>
                    </label>
                </span>
                <span class="action-buttons">
                    <button class="btn-icon btn-edit" (click)="onEdit(e)" title="Editar Estado">‚úèÔ∏è EDIT</button>
                    <button class="btn-icon btn-delete" (click)="onDelete(e)" title="Eliminar">üóëÔ∏è DELETE </button>
                </span>
            </div>

            <p *ngIf="eventos.length === 0" class="empty-state">No hay eventos disponibles.</p>
        </div>

        <!-- Edit Form -->
        <div *ngIf="editingEvento" class="edit-form">
            <h2>Editando Evento</h2>
            <form (ngSubmit)="onSave(editingEvento!)">
                <div class="form-group">
                    <label for="nombre">Nombre</label>
                    <input type="text" id="nombre" [(ngModel)]="editingEvento.nombre" name="nombre">
                </div>
                <div class="form-group">
                    <label for="ciudad">Ciudad</label>
                    <select id="ciudad" [(ngModel)]="editingEvento.ciudad" name="ciudad">
                        <option *ngFor="let city of cities" [ngValue]="city.nombre">{{ city.nombre }}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="category">Categor√≠a</label>
                    <select id="category" [(ngModel)]="editingEvento.category" name="category">
                        <option *ngFor="let cat of categories" [ngValue]="cat.nombre">{{ cat.nombre }}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="price">Precio</label>
                    <input type="number" id="price" [(ngModel)]="editingEvento.price" name="price">
                </div>
                <div class="form-group">
                    <label for="isActive">Activo</label>
                    <input type="checkbox" id="isActive" [(ngModel)]="editingEvento.isActive" name="isActive">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-save">Guardar</button>
                    <button type="button" class="btn-cancel" (click)="onCancel()">Cancelar</button>
                </div>
            </form>
        </div>

        <!-- Create Form -->
        <div *ngIf="creatingEvento" class="edit-form">
            <h2>Creando Evento</h2>
            <form (ngSubmit)="onSaveNewEvento()">
                <div class="form-group">
                    <label for="new-nombre">Nombre</label>
                    <input type="text" id="new-nombre" [(ngModel)]="newEvento.nombre" name="new-nombre">
                </div>
                <div class="form-group">
                    <label for="new-ciudad">Ciudad</label>
                    <select id="new-ciudad" [(ngModel)]="newEvento.ciudad" name="new-ciudad">
                        <option *ngFor="let city of cities" [ngValue]="city.nombre">{{ city.nombre }}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="new-category">Categor√≠a</label>
                    <select id="new-category" [(ngModel)]="newEvento.category" name="new-category">
                        <option *ngFor="let cat of categories" [ngValue]="cat.nombre">{{ cat.nombre }}</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="new-price">Precio</label>
                    <input type="number" id="new-price" [(ngModel)]="newEvento.price" name="new-price">
                </div>
                <div class="form-group">
                    <label for="new-isActive">Activo</label>
                    <input type="checkbox" id="new-isActive" [(ngModel)]="newEvento.isActive" name="new-isActive">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn-save">Guardar</button>
                    <button type="button" class="btn-cancel" (click)="onCancelNewEvento()">Cancelar</button>
                </div>
            </form>
        </div>
        <!-- Categories -->
        <div *ngIf="selectedMenuItem === 'Categories' && !editingCategory" class="event-grid">
            <div class="event-grid-header">
                <span>Nombre</span>
                <span>Estado</span>
                <span>Acciones</span>
            </div>

            <div *ngFor="let c of categories" class="event-grid-row">
                <span>{{ c.nombre }}</span>

                <span>
                    <label class="toggle-switch">
                        <input type="checkbox" [checked]="c.isActive" disabled>
                        <span class="slider"></span>
                    </label>
                </span>

                <span class="action-buttons">
                    <button class="btn-icon btn-edit" (click)="onEditCategory(c)" title="Editar categor√≠a">‚úèÔ∏è
                        EDIT</button>
                    <button class="btn-icon btn-delete" (click)="onDeleteCategory(c)" title="Eliminar categor√≠a">üóëÔ∏è
                        DELETE</button>
                </span>
            </div>

            <p *ngIf="categories.length === 0" class="empty-state">No hay categor√≠as disponibles.</p>
        </div>

        <!-- Edit Category Form -->
        <div *ngIf="editingCategory" class="edit-form">
            <h2>Editando Categor√≠a</h2>
            <form (ngSubmit)="onSaveCategory(editingCategory!)">
                <div class="form-group">
                    <label for="cat-nombre">Nombre</label>
                    <input type="text" id="cat-nombre" [(ngModel)]="editingCategory.nombre" name="catNombre">
                </div>

                <div class="form-group">
                    <label for="cat-descripcion">Descripci√≥n</label>
                    <textarea id="cat-descripcion" [(ngModel)]="editingCategory.descripcion" name="catDescripcion"
                        rows="4"></textarea>
                </div>

                <div class="form-group">
                    <label for="cat-isActive">Activo</label>
                    <input type="checkbox" id="cat-isActive" [(ngModel)]="editingCategory.isActive" name="catIsActive">
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn-save">Guardar</button>
                    <button type="button" class="btn-cancel" (click)="onCancelCategory()">Cancelar</button> -->
                </div>
            </form>
        </div>

        <!-- Clients -->
        <div *ngIf="selectedMenuItem === 'Clients'" class="event-grid">
            <div class="event-grid-header">
                <span>Usuario</span>
                <span>Email</span>
                <span>Estado</span>
                <span>Activo</span>
                <span>Acciones</span>
            </div>

            <div *ngFor="let u of users" class="event-grid-row">
                <span>{{ u.username }}</span>
                <span>{{ u.email }}</span>

                <span>
                    <label class="toggle-switch">
                        <input type="checkbox" [checked]="u.isActive" disabled>
                        <span class="slider"></span>
                    </label>
                </span>


                <span class="action-buttons">
                    <button class="btn-icon btn-edit" (click)="onEditUser(u)" title="Editar usuario">‚úèÔ∏è EDIT</button>
                    <button class="btn-icon btn-delete" (click)="onDeleteUser(u)" title="Eliminar usuario">üóëÔ∏è
                        DELETE</button>
                </span>
            </div>

            <p *ngIf="users.length === 0" class="empty-state">No hay usuarios disponibles.</p>
        </div>

        <!-- Edit User Form -->
        <div *ngIf="editingUser" class="edit-form">
            <h3>Editar Usuario: {{ editingUser?.username }}</h3>
            <form (ngSubmit)="onSaveUser(editingUser!)">
                <label>Email</label>
                <input type="email" [(ngModel)]="editingUser.email" name="email" required />

                <label>Imagen (URL)</label>
                <input type="text" [(ngModel)]="editingUser.image" name="image" />

                <label>Estado</label>
                <select [(ngModel)]="editingUser.status" name="status">
                    <option value="PUBLISHED">PUBLISHED</option>
                    <option value="DRAFT">DRAFT</option>
                    <option value="ARCHIVED">ARCHIVED</option>
                </select>

                <label>
                    <input type="checkbox" [(ngModel)]="editingUser.isActive" name="isActive" />
                    Activo
                </label>

                <div class="modal-actions">
                    <button type="submit" class="btn-save">Guardar</button>
                    <button type="button" class="btn-cancel" (click)="onCancelUser()">Cancelar</button>
                </div>
            </form>
        </div>
    </main>
</div>