<div class="settings-container">
  <button class="back-button" (click)="goBack()" type="button">
    ← Volver al Perfil
  </button>

  <h2>Configuración</h2>

  <form [formGroup]="settingsForm" (ngSubmit)="submitForm()">
    <div class="form-group">
      <label for="image">Imagen de perfil</label>
      <input type="text" id="image" formControlName="image" class="form-control" placeholder="URL de la imagen" />
    </div>

    <div class="form-group">
      <label for="username">Nombre de usuario</label>
      <input type="text" id="username" formControlName="username" class="form-control"
        placeholder="Nombre de usuario" />
      <div class="error-message" *ngIf="username?.invalid && username?.touched">
        <span *ngIf="username?.errors?.['required']">El nombre de usuario es requerido</span>
        <span *ngIf="username?.errors?.['minlength']">Mínimo 6 caracteres</span>
        <span *ngIf="username?.errors?.['maxlength']">Máximo 20 caracteres</span>
      </div>
    </div>

    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" id="email" formControlName="email" class="form-control" placeholder="Email" />
      <div class="error-message" *ngIf="email?.invalid && email?.touched">
        <span *ngIf="email?.errors?.['required']">El email es requerido</span>
        <span *ngIf="email?.errors?.['email'] || email?.errors?.['pattern']">
          Formato de email inválido
        </span>
      </div>
    </div>

    <div class="form-group">
      <label for="password">Contraseña</label>
      <input type="password" id="password" formControlName="password" class="form-control"
        placeholder="Dejar en blanco para no cambiar" />
      <div class="error-message" *ngIf="password?.invalid && password?.touched">
        <span *ngIf="password?.errors?.['minlength']">Mínimo 6 caracteres</span>
        <span *ngIf="password?.errors?.['maxlength']">Máximo 20 caracteres</span>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-primary" [disabled]="isSubmitting || settingsForm.invalid">
        {{ isSubmitting ? 'Guardando...' : 'Guardar Cambios' }}
      </button>

      <button type="button" class="btn btn-secondary" (click)="goBack()" [disabled]="isSubmitting">
        Cancelar
      </button>
    </div>
  </form>

  <div class="error-message" *ngIf="hasErrors()">
    <div *ngFor="let error of getErrorKeys()">
      {{ error }}: {{ getErrorMessage(error) }}
    </div>
  </div>
</div>